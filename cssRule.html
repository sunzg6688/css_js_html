<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>选择 css 文件，解析并展示css 文件内容</title>
    <link rel="stylesheet" href="css/common_lib.css">
</head>
<style>
    #classRulesDiv div{
        margin-top: 15px;
    }

    .textArea{
        font-size: 18px;
    }

    #textArea{
        font-size: 20px;
    }
</style>
<body class="w_100">

<div class="w_40 m_20px_a">
    <input type="file" id="file" value="选择css文件">
</div>
<div class="m_20px_a w_40">
    <button class="w_100 c_p" style="height: 20px;line-height: 20px" value="显示需要复制的文本" onclick="showTextArea()">显示需要复制的文本</button>
</div>
<div id="textAreaDiv" class="d_n m_20px_a w_90">
    <span class="w_100 textArea" id="textArea" style="word-wrap:break-word;"></span>
</div>
<div id="classRulesDiv" class="m_20px_a w_40">
</div>

</body>
<script>

    var is_show=false;

    function showTextArea(){

        is_show=!is_show;

        if(is_show){

            document.getElementById("textArea").innerText=classes_string;

            document.getElementById("textAreaDiv").style.display="block";

        }else{
            document.getElementById("textAreaDiv").style.display="none";
        }
    }

    document.getElementById("file").addEventListener("change",fileSelected,false);

    var cssRule;

    function fileSelected(event){

        var file=event.target;

        if (file.files && file.files[0])
        {

            var reader = new FileReader();

            reader.onload = function(evt){

                cssRule=evt.target.result;

                parseCss();

            }

            reader.readAsText(file.files[0]);

        }
    }

    var classes={};

    var classes_string="";

    function parseCss(){

        cssRule=cssRule.replace(/ /g,"");

        cssRule=cssRule.replace(/[ ]/g,"");

        cssRule=cssRule.replace(/[\r\n]/g,"");

        var class_arr=cssRule.split("}");

        for(var i=0;i<class_arr.length;i++) {

            var class_string = class_arr[i];

            var class_begin = class_string.indexOf(".");

            var class_content_begin = class_string.indexOf("{");

            var class_content_end = class_string.length;

            var class_name = class_string.slice(class_begin, class_content_begin);

            var class_content = class_string.slice(class_content_begin + 1, class_content_end);

            classes[class_name] = class_content;

            var str=class_name+"{"+class_content+"}";

            if(class_content&&class_name){

                classes_string+=str;

                initClassDiv(str);

            }

        }

        console.log("classes_string:",classes_string);
    }

    var classRulesDiv=document.getElementById("classRulesDiv");

    function initClassDiv(str){

        var div=document.createElement("div");

        div.innerHTML=str;

        classRulesDiv.appendChild(div);

    }

</script>
</html>